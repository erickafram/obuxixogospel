        </div>
    </div>
    
    <script>
        // Mobile Menu Toggle
        document.addEventListener('DOMContentLoaded', function() {
            const mobileMenuToggle = document.getElementById('mobileMenuToggle');
            const sidebar = document.querySelector('.sidebar');
            const mobileOverlay = document.getElementById('mobileOverlay');
            
            if (mobileMenuToggle) {
                mobileMenuToggle.addEventListener('click', function() {
                    sidebar.classList.toggle('active');
                    mobileOverlay.classList.toggle('active');
                    document.body.style.overflow = sidebar.classList.contains('active') ? 'hidden' : '';
                });
            }
            
            if (mobileOverlay) {
                mobileOverlay.addEventListener('click', function() {
                    sidebar.classList.remove('active');
                    mobileOverlay.classList.remove('active');
                    document.body.style.overflow = '';
                });
            }
            
            // Fechar menu ao clicar em um link
            const menuItems = document.querySelectorAll('.sidebar .menu-item');
            menuItems.forEach(item => {
                item.addEventListener('click', function() {
                    if (window.innerWidth <= 768) {
                        sidebar.classList.remove('active');
                        mobileOverlay.classList.remove('active');
                        document.body.style.overflow = '';
                    }
                });
            });
        });
        
        // Sistema de Notificações
        let notificationInterval;
        
        // Carregar contagem de notificações ao iniciar
        document.addEventListener('DOMContentLoaded', function() {
            loadNotificationCount();
            // Atualizar a cada 30 segundos
            notificationInterval = setInterval(loadNotificationCount, 30000);
        });
        
        // Carregar contagem de notificações não lidas
        async function loadNotificationCount() {
            try {
                const response = await fetch('/api/notifications/count');
                const data = await response.json();
                
                if (data.success && data.count > 0) {
                    document.getElementById('notificationBadge').textContent = data.count;
                    document.getElementById('notificationBadge').style.display = 'block';
                } else {
                    document.getElementById('notificationBadge').style.display = 'none';
                }
            } catch (error) {
                console.error('Erro ao carregar contagem de notificações:', error);
            }
        }
        
        // Toggle painel de notificações
        async function toggleNotifications() {
            const panel = document.getElementById('notificationPanel');
            
            if (panel.style.display === 'none') {
                panel.style.display = 'block';
                await loadNotifications();
            } else {
                panel.style.display = 'none';
            }
        }
        
        // Carregar notificações
        async function loadNotifications() {
            const listElement = document.getElementById('notificationList');
            
            try {
                const response = await fetch('/api/notifications/unread');
                const data = await response.json();
                
                if (!data.success || data.notifications.length === 0) {
                    listElement.innerHTML = `
                        <div class="notification-empty">
                            <i class="fas fa-bell-slash"></i>
                            <p>Nenhuma notificação nova</p>
                        </div>
                    `;
                    return;
                }
                
                listElement.innerHTML = data.notifications.map(notif => {
                    const iconClass = notif.type === 'new_post' ? 'new-post' : 'error';
                    const icon = notif.type === 'new_post' ? 'fa-instagram' : 'fa-exclamation-circle';
                    const timeAgo = getTimeAgo(new Date(notif.created_at));
                    
                    return `
                        <div class="notification-item ${notif.isRead ? '' : 'unread'}" onclick="handleNotificationClick(${notif.id}, '${notif.link}')">
                            <div class="notification-icon ${iconClass}">
                                <i class="fas ${icon}"></i>
                            </div>
                            <div class="notification-content">
                                <div class="notification-title">${notif.title}</div>
                                <div class="notification-message">${notif.message}</div>
                                <div class="notification-time">
                                    <i class="fas fa-clock"></i> ${timeAgo}
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
                
            } catch (error) {
                console.error('Erro ao carregar notificações:', error);
                listElement.innerHTML = `
                    <div class="notification-empty">
                        <i class="fas fa-exclamation-triangle"></i>
                        <p>Erro ao carregar notificações</p>
                    </div>
                `;
            }
        }
        
        // Marcar notificação como lida e redirecionar
        async function handleNotificationClick(notifId, link) {
            try {
                await fetch(`/api/notifications/${notifId}/read`, {
                    method: 'PUT'
                });
                
                await loadNotificationCount();
                
                if (link) {
                    window.location.href = link;
                }
            } catch (error) {
                console.error('Erro ao marcar notificação:', error);
            }
        }
        
        // Marcar todas como lidas
        async function markAllAsRead() {
            try {
                const response = await fetch('/api/notifications/read-all', {
                    method: 'PUT'
                });
                
                const data = await response.json();
                
                if (data.success) {
                    await loadNotifications();
                    await loadNotificationCount();
                }
            } catch (error) {
                console.error('Erro ao marcar todas como lidas:', error);
            }
        }
        
        // Calcular tempo relativo
        function getTimeAgo(date) {
            const seconds = Math.floor((new Date() - date) / 1000);
            
            if (seconds < 60) return 'Agora mesmo';
            
            const minutes = Math.floor(seconds / 60);
            if (minutes < 60) return `${minutes} min atrás`;
            
            const hours = Math.floor(minutes / 60);
            if (hours < 24) return `${hours}h atrás`;
            
            const days = Math.floor(hours / 24);
            if (days < 7) return `${days}d atrás`;
            
            return date.toLocaleDateString('pt-BR');
        }
        
        // Fechar painel ao clicar fora
        document.addEventListener('click', function(event) {
            const panel = document.getElementById('notificationPanel');
            const bell = document.getElementById('notificationBell');
            
            if (panel.style.display === 'block' && 
                !panel.contains(event.target) && 
                !bell.contains(event.target)) {
                panel.style.display = 'none';
            }
        });
    </script>
</body>
</html>
